# 구글드라이브 설계

## 내용정리

- `파일 저장` 및 `동기화 서비스`
- 어떤 단말에서도 이용가능해야한다
- 파일은 공유 가능해야한다.
- 업로드 / 다운로드 / 파일동기화 / 알림
- 파일크기 10G

- 드레그 앤 드롭
- 파일 다운로드
- 갱신이력 조회 (revision history)

- 안정성
- 동기화 속도
- 네트워크 대역폭 v
- 확장성
- 가용성

## 설계

- 파일 업로드 , 다운로드를 처리할 `웹서버`
- 사용자 데이터, 로그인정보, 파일 정보등의 메타데이터를 보관할 DB
- 파일을 저장할 저장소 시스템 (?? 뭐로 구성해야하지)

- 파일업로드 API
  - 단순 업로드
  - 이어 올리기
- 파일다운로드 API
- 파일 갱신 히스토리 API

### 동기화 충돌

### 개략적 설계

- 블록 저장소 서버
  - 파일을 여러개의 블록으로 나눠 저장한다. 각 블록은 고유한 해시값이 할당되며, 해시값은 메타데이터 DB에 저장된다. 각 블록은 클라우드 저장소 (S3)에 보관된다.
- 클라우드 저장소
- 아카이빙 저장소
  - 오랫동안 사용되지 않은 비활성 데이터를 저장
- API 서버
  - 파일 업로드 이외 모든 것을 담당하는 서버. 메타데이터 갱신에 사용된다.
- 메타데이터 데이터베이스
- 메타데이터 캐시
- 알림 서비스
  - pub/sub 프로토콜 기반 시스템.

### 상세 설계

**블록 저장소 서버**

- 파일 블록단위 분할
- 블록 압축
- 암호화
- 수정된 블록만 전송
  ```
  ❓수정된 블록 식별을 어떻게하나?
  ```

**높은 일관성 요구사항**

**메타데이터 데이터베이스**

**업로드 절차**

**파일 다운로드 절차**

**저장소 공간 절약**

**장애 처리**

### 경험

### 키워드

- 델타 동기화
